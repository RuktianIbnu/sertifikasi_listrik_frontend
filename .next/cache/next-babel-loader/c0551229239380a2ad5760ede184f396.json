{"ast":null,"code":"import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport React, { useState, useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport { Visibility, Edit, Delete, CheckBox, RadioButtonChecked, Publish, Subject } from \"@material-ui/icons\";\nimport { Tooltip } from \"@material-ui/core\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { axiosGeneral } from \"../../helpers/global\";\nimport ReactLoading from \"react-loading\";\nimport { Modal } from \"react-bootstrap\";\nimport { useToasts } from \"react-toast-notifications\";\nimport { setLoading } from \"../../store/actionCreator\";\nimport Search from \"../../components/Search\";\nconst Wrapper = styled.div`\n  padding: 23px 54px 0px 54px;\n`;\nconst MenuTitle = styled.h1`\n  font-size: 48px;\n  font-weight: bold;\n  color: #000;\n`;\nconst ButtonAdd = styled.div`\n  font-size: 14px;\n  background: #4361ee;\n  color: #fff;\n  padding: 10px 23px;\n  border-radius: 10px;\n  font-weight: 700;\n  cursor: pointer;\n`;\nconst Card = styled.div`\n  background: #fff;\n  border-radius: 10px;\n  box-shadow: 2px 2px 7px rgba(0, 0, 0, 0.25);\n  padding: 30px 46px 30px 46px;\n`;\nexport default function Tipe() {\n  const {\n    0: selectedTipeID,\n    1: setSelectedTipeID\n  } = useState();\n  const accessToken = useSelector(state => state.accessToken);\n  const {\n    0: listPoinItem,\n    1: setlistPoinItem\n  } = useState([]);\n  const {\n    0: showDetail,\n    1: setShowDetail\n  } = useState(false);\n  const {\n    0: showAdd,\n    1: setShowAdd\n  } = useState(false);\n  const {\n    0: showEdit,\n    1: setShowEdit\n  } = useState(false);\n  const {\n    0: kode,\n    1: setKode\n  } = useState(\"\");\n  const {\n    0: tipe,\n    1: setTipe\n  } = useState(\"\");\n  const {\n    0: deskripsi,\n    1: setDeskripsi\n  } = useState(\"\");\n  const {\n    addToast\n  } = useToasts();\n  const dispatch = useDispatch();\n  const {\n    0: selectedID,\n    1: setSelectedID\n  } = useState();\n  useEffect(() => {\n    getTipePoint();\n  }, [showDetail]);\n\n  const createTipePoin = async () => {\n    try {\n      const headers = {\n        Authorization: `Bearer ${accessToken}`\n      };\n      const body = {\n        kode,\n        tipe,\n        deskripsi: document.getElementById(\"tipe_deskripsi\").innerText\n      };\n      const response = await axiosGeneral.post(\"/resources/tipe-poin\", body, {\n        headers\n      });\n      const {\n        status\n      } = response;\n\n      if (status === 200) {\n        setShowAdd(false);\n        addToast(\"Tipe poin berhasil ditambahkan\", {\n          appearance: \"success\"\n        });\n        getTipePoint();\n      }\n\n      console.log(body);\n    } catch (error) {\n      addToast(error.response.data.message, {\n        appearance: \"error\"\n      });\n    }\n  };\n\n  const getTipePoint = async () => {\n    try {\n      const headers = {\n        Authorization: `Bearer ${accessToken}`\n      };\n      dispatch(setLoading(true));\n      setlistPoinItem([]);\n      const response = await axiosGeneral.get(\"resources/tipe-poin?showItem=false\", {\n        headers\n      });\n      const {\n        data,\n        status\n      } = response;\n\n      if (status === 200) {\n        setlistPoinItem(data.data);\n        dispatch(setLoading(false));\n      }\n    } catch (error) {\n      addToast(error.response.data.message, {\n        appearance: \"error\"\n      });\n      dispatch(setLoading(false));\n    }\n  };\n\n  const deleteTipePoin = async id => {\n    try {\n      const headers = {\n        Authorization: `Bearer ${accessToken}`\n      };\n      dispatch(setLoading(true));\n      const response = await axiosGeneral.delete(`/resources/tipe-poin/${id}`, {\n        headers\n      });\n      const {\n        status\n      } = response;\n\n      if (status === 200) {\n        addToast(\"Tipe poin berhasil dihapus\", {\n          appearance: \"success\"\n        });\n        getTipePoint();\n        dispatch(setLoading(false));\n      }\n    } catch (error) {\n      addToast(error.response.data.message, {\n        appearance: \"error\"\n      });\n      dispatch(setLoading(false));\n    }\n  };\n\n  const editTipePoin = async id => {\n    try {\n      const headers = {\n        Authorization: `Bearer ${accessToken}`\n      };\n      const body = {\n        kode,\n        tipe,\n        deskripsi\n      };\n      dispatch(setLoading(true));\n      setShowEdit(false);\n      const response = await axiosGeneral.put(`/resources/tipe-poin/${id}`, body, {\n        headers\n      });\n      const {\n        status\n      } = response;\n\n      if (status === 200) {\n        dispatch(setLoading(false)); // make it empty\n\n        setSelectedID();\n        setKode();\n        setTipe();\n        setDeskripsi();\n        addToast(\"Berhasil update tipe poin\", {\n          appearance: \"success\"\n        });\n        getTipePoint();\n      }\n    } catch (error) {\n      addToast(error.response.data.message, {\n        appearance: \"error\"\n      });\n      console.log(error);\n      dispatch(setLoading(false));\n    }\n  };\n\n  return /*#__PURE__*/_jsxs(Wrapper, {\n    children: [/*#__PURE__*/_jsxs(\"div\", {\n      className: \"flex flex-row justify-between items-center pb-24\",\n      children: [/*#__PURE__*/_jsx(MenuTitle, {\n        children: \"Master Tipe Poin\"\n      }), /*#__PURE__*/_jsx(ButtonAdd, {\n        onClick: () => setShowAdd(true),\n        className: \"cursor-pointer\",\n        children: \"Tambah Kuisioner baru\"\n      })]\n    }), /*#__PURE__*/_jsx(Search, {}), /*#__PURE__*/_jsx(Card, {\n      children: showDetail === true ? /*#__PURE__*/_jsx(TipePoinItem, {\n        setShowDetail: () => setShowDetail(false),\n        id: selectedTipeID\n      }) : /*#__PURE__*/_jsxs(\"div\", {\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"flex mb-6\"\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"flex flex-row font-bold text-sm mb-3 text-left border-b-2 pb-2\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"w-10\",\n            children: \"#\"\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"w-36\",\n            children: \"Kode\"\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"w-52\",\n            children: \"Tipe\"\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"w-3/5\",\n            children: \"Deskripsi\"\n          }), /*#__PURE__*/_jsx(\"div\", {\n            children: \"Action\"\n          })]\n        }), listPoinItem.map((value, index) => /*#__PURE__*/_jsxs(\"div\", {\n          className: \"flex flex-row py-3 border-b items-center\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"w-10\",\n            children: index + 1\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"w-36\",\n            children: value.kode\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"w-52\",\n            children: value.tipe\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"w-3/5\",\n            children: value.deskripsi\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"grid grid-cols-3 gap-3\",\n            children: [/*#__PURE__*/_jsx(Tooltip, {\n              onClick: () => {\n                setSelectedID(value.id);\n                setKode(value.kode);\n                setTipe(value.tipe);\n                setDeskripsi(value.deskripsi);\n                setShowEdit(true);\n              },\n              title: \"Edit\",\n              children: /*#__PURE__*/_jsx(Edit, {\n                className: \"cursor-pointer\",\n                size: \"24px\"\n              })\n            }), /*#__PURE__*/_jsx(Tooltip, {\n              onClick: () => deleteTipePoin(value.id),\n              title: \"Hapus\",\n              children: /*#__PURE__*/_jsx(Delete, {\n                className: \"cursor-pointer\",\n                size: \"24px\"\n              })\n            }), /*#__PURE__*/_jsx(Tooltip, {\n              onClick: () => {\n                setShowDetail(true);\n                setSelectedTipeID(value.id);\n              },\n              title: `Detail - ${value.tipe}`,\n              children: /*#__PURE__*/_jsx(Visibility, {\n                className: \"cursor-pointer\",\n                size: \"24px\"\n              })\n            })]\n          })]\n        }, index)), /*#__PURE__*/_jsx(Modal, {\n          show: showAdd,\n          onHide: () => setShowAdd(false),\n          children: /*#__PURE__*/_jsxs(\"div\", {\n            className: \"p-4\",\n            children: [/*#__PURE__*/_jsxs(\"div\", {\n              className: \"col-span-6 sm:col-span-3\",\n              children: [/*#__PURE__*/_jsxs(\"div\", {\n                className: \"mt-3\",\n                children: [/*#__PURE__*/_jsx(\"label\", {\n                  className: \"text-sm font-bold pb-0\",\n                  children: \"Kode\"\n                }), /*#__PURE__*/_jsx(\"input\", {\n                  type: \"text\",\n                  onChange: e => setKode(e.target.value),\n                  className: \"block w-full  text-sm py-2 px-3 bg-gray-300 rounded focus:outline-none\"\n                })]\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                className: \"mt-3\",\n                children: [/*#__PURE__*/_jsx(\"label\", {\n                  className: \"text-sm font-bold pb-0\",\n                  children: \"Tipe\"\n                }), /*#__PURE__*/_jsx(\"input\", {\n                  type: \"text\",\n                  onChange: e => setTipe(e.target.value),\n                  className: \"block w-full  text-sm py-2 px-3 bg-gray-300 rounded focus:outline-none\"\n                })]\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                className: \"mt-3\",\n                children: [/*#__PURE__*/_jsx(\"label\", {\n                  className: \"text-sm font-bold pb-0\",\n                  children: \"Deskripsi\"\n                }), /*#__PURE__*/_jsx(\"span\", {\n                  id: \"tipe_deskripsi\",\n                  className: \"text-sm py-2 w-full block bg-gray-300 px-3 rounded focus:outline-none\",\n                  contentEditable: true\n                })]\n              })]\n            }), /*#__PURE__*/_jsx(\"div\", {\n              onClick: createTipePoin,\n              className: \"py-2 px-4 text-center mt-4 bg-blue-400 text-white rounded-lg text-sm cursor-pointer\",\n              children: \"Tambah Tipe Poin\"\n            })]\n          })\n        }), selectedID && /*#__PURE__*/_jsx(Modal, {\n          show: showEdit,\n          onHide: () => setShowEdit(false),\n          children: /*#__PURE__*/_jsxs(\"div\", {\n            className: \"p-4\",\n            children: [/*#__PURE__*/_jsxs(\"div\", {\n              className: \"col-span-6 sm:col-span-3\",\n              children: [/*#__PURE__*/_jsxs(\"div\", {\n                className: \"mt-3\",\n                children: [/*#__PURE__*/_jsx(\"label\", {\n                  className: \"text-sm font-bold pb-0\",\n                  children: \"Kode\"\n                }), /*#__PURE__*/_jsx(\"input\", {\n                  type: \"text\",\n                  onChange: e => setKode(e.target.value),\n                  value: kode,\n                  className: \"block w-full  text-sm py-2 px-3 bg-gray-300 rounded focus:outline-none\"\n                })]\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                className: \"mt-3\",\n                children: [/*#__PURE__*/_jsx(\"label\", {\n                  className: \"text-sm font-bold pb-0\",\n                  children: \"Tipe\"\n                }), /*#__PURE__*/_jsx(\"input\", {\n                  type: \"text\",\n                  onChange: e => setTipe(e.target.value),\n                  value: tipe,\n                  className: \"block w-full  text-sm py-2 px-3 bg-gray-300 rounded focus:outline-none\"\n                })]\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                className: \"mt-3\",\n                children: [/*#__PURE__*/_jsx(\"label\", {\n                  className: \"text-sm font-bold pb-0\",\n                  children: \"Deskripsi\"\n                }), /*#__PURE__*/_jsx(\"textarea\", {\n                  value: deskripsi,\n                  onChange: e => setDeskripsi(e.target.value),\n                  className: \"text-sm py-2 w-full block bg-gray-300 px-3 rounded focus:outline-none\"\n                })]\n              })]\n            }), /*#__PURE__*/_jsx(\"div\", {\n              onClick: () => editTipePoin(selectedID),\n              className: \"py-2 px-4 text-center mt-4 bg-blue-400 text-white rounded-lg text-sm cursor-pointer\",\n              children: \"Update Tipe Poin\"\n            })]\n          })\n        })]\n      })\n    })]\n  });\n}\n\nconst TipePoinItem = ({\n  id,\n  setShowDetail\n}) => {\n  const accessToken = useSelector(state => state.accessToken);\n  const {\n    0: tipePoinDetail,\n    1: setTipePoinDetail\n  } = useState();\n  const {\n    0: showAdd,\n    1: setShowAdd\n  } = useState(false);\n  const {\n    0: controlType,\n    1: setControlType\n  } = useState();\n  const {\n    addToast\n  } = useToasts();\n  const dispatch = useDispatch();\n  useEffect(() => {\n    getTipePoinByID();\n  }, []);\n\n  const getTipePoinByID = async () => {\n    try {\n      const headers = {\n        Authorization: `Bearer ${accessToken}`\n      };\n      setTipePoinDetail();\n      dispatch(setLoading(true));\n      const response = await axiosGeneral.get(`/resources/tipe-poin/${id}`, {\n        headers\n      });\n      const {\n        data,\n        status\n      } = response;\n\n      if (status === 200) {\n        setTipePoinDetail(data.data);\n        dispatch(setLoading(false));\n      }\n    } catch (error) {\n      addToast(error.response.data.message, {\n        appearance: \"error\"\n      });\n      dispatch(setLoading(false));\n    }\n  };\n\n  const createCreatePoinItem = async () => {\n    try {\n      const headers = {\n        Authorization: `Bearer ${accessToken}`\n      };\n      const body = {\n        id_tipe_poin: id,\n        control_type: controlType\n      };\n      const response = await axiosGeneral.post(\"/resources/tipe-poin-item\", body, {\n        headers\n      });\n      const {\n        status\n      } = response;\n\n      if (status === 200) {\n        addToast(\"Item berhasil ditambahkan\", {\n          appearance: \"success\"\n        });\n        setShowAdd(false);\n        getTipePoinByID();\n      }\n    } catch (error) {\n      addToast(error.response.data.message, {\n        appearance: \"error\"\n      });\n    }\n  };\n\n  const deletePoinItem = async id => {\n    try {\n      const headers = {\n        Authorization: `Bearer ${accessToken}`\n      };\n      dispatch(setLoading(true));\n      const response = await axiosGeneral.delete(`/resources/tipe-poin-item/${id}`, {\n        headers\n      });\n      const {\n        status\n      } = response;\n\n      if (status === 200) {\n        addToast(\"Item berhasil dihapus\", {\n          appearance: \"success\"\n        });\n        dispatch(setLoading(false));\n        getTipePoinByID();\n      }\n    } catch (error) {\n      addToast(error.response.data.message, {\n        appearance: \"error\"\n      });\n      dispatch(setLoading(false));\n    }\n  };\n\n  if (!tipePoinDetail) {\n    return /*#__PURE__*/_jsx(\"h1\", {\n      children: \"Loading...\"\n    });\n  }\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    children: [/*#__PURE__*/_jsxs(\"div\", {\n      className: \"flex flex-row justify-between mb-4\",\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        onClick: setShowDetail,\n        className: \"py-2 px-4 bg-blue-400 text-white rounded-lg text-sm cursor-pointer\",\n        children: \"Kembali\"\n      }), /*#__PURE__*/_jsx(\"div\", {\n        onClick: () => setShowAdd(true),\n        className: \"py-2 px-4 bg-blue-400 text-white rounded-lg text-sm cursor-pointer\",\n        children: \"Tambah Poin Item Baru\"\n      })]\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: \"flex flex-row gap-6\",\n      children: [/*#__PURE__*/_jsxs(\"div\", {\n        className: \"w-1/4\",\n        children: [/*#__PURE__*/_jsxs(\"div\", {\n          className: \"mt-3\",\n          children: [/*#__PURE__*/_jsx(\"label\", {\n            className: \"text-sm font-bold pb-0\",\n            children: \"Kode\"\n          }), /*#__PURE__*/_jsx(\"p\", {\n            className: \"text-sm py-2 w-full\",\n            children: tipePoinDetail.kode\n          })]\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"mt-3\",\n          children: [/*#__PURE__*/_jsx(\"label\", {\n            className: \"text-sm font-bold pb-0\",\n            children: \"Tipe\"\n          }), /*#__PURE__*/_jsx(\"p\", {\n            className: \"text-sm py-2 w-full\",\n            children: tipePoinDetail.tipe\n          })]\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"mt-3\",\n          children: [/*#__PURE__*/_jsx(\"label\", {\n            className: \"text-sm font-bold pb-0\",\n            children: \"Deskripsi\"\n          }), /*#__PURE__*/_jsx(\"p\", {\n            className: \"text-sm py-2 w-full\",\n            children: tipePoinDetail.deskripsi\n          })]\n        })]\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"w-full border-l-2 pl-4\",\n        children: [/*#__PURE__*/_jsxs(\"div\", {\n          className: \"flex flex-row font-bold text-sm mb-3 text-left border-b-2 pb-2\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"w-10\",\n            children: \"#\"\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"text-center w-36\",\n            children: \"Tipe Kontrol\"\n          }), /*#__PURE__*/_jsx(\"div\", {\n            children: \"Action\"\n          })]\n        }), tipePoinDetail.item.map((value, index) => /*#__PURE__*/_jsxs(\"div\", {\n          className: \"flex flex-row py-3 items-center\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"w-10\",\n            children: index + 1\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"text-center w-36\",\n            children: [value.control_type === \"upload_file\" && /*#__PURE__*/_jsx(Tooltip, {\n              title: \"Upload file\",\n              children: /*#__PURE__*/_jsx(Publish, {\n                htmlColor: \"#6B7280\"\n              })\n            }), value.control_type === \"option\" && /*#__PURE__*/_jsx(Tooltip, {\n              title: \"Pilihan\",\n              children: /*#__PURE__*/_jsx(RadioButtonChecked, {\n                htmlColor: \"#6B7280\"\n              })\n            }), value.control_type === \"checkbox\" && /*#__PURE__*/_jsx(Tooltip, {\n              title: \"Pilihan ganda\",\n              children: /*#__PURE__*/_jsx(CheckBox, {\n                htmlColor: \"#6B7280\"\n              })\n            }), value.control_type === \"freetext\" && /*#__PURE__*/_jsx(Tooltip, {\n              title: \"Isian\",\n              children: /*#__PURE__*/_jsx(Subject, {\n                htmlColor: \"#6B7280\"\n              })\n            })]\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"grid grid-cols-3 text-center\",\n            children: /*#__PURE__*/_jsx(Tooltip, {\n              onClick: () => deletePoinItem(value.id),\n              title: \"Hapus\",\n              children: /*#__PURE__*/_jsx(Delete, {\n                className: \"cursor-pointer\",\n                size: \"24px\"\n              })\n            })\n          })]\n        }, index))]\n      })]\n    }), /*#__PURE__*/_jsx(Modal, {\n      show: showAdd,\n      size: \"sm\",\n      onHide: () => setShowAdd(false),\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: \"p-4\",\n        children: [/*#__PURE__*/_jsxs(\"div\", {\n          className: \"col-span-6 sm:col-span-3\",\n          children: [/*#__PURE__*/_jsx(\"label\", {\n            className: \"font-bold text-black text-sm\",\n            children: \"Tipe\"\n          }), /*#__PURE__*/_jsxs(\"select\", {\n            onChange: e => setControlType(e.target.value),\n            id: \"atasan\",\n            name: \"atasan\",\n            autocomplete: \"atasan\",\n            defaultValue: \"NULL\",\n            className: \"w-full bg-gray-200 rounded-xl py-2 px-4 font-nunito focus:outline-none\",\n            children: [/*#__PURE__*/_jsx(\"option\", {\n              value: \"NULL\",\n              disabled: true\n            }), /*#__PURE__*/_jsx(\"option\", {\n              value: \"freetext\",\n              children: \"Freetext\"\n            }), /*#__PURE__*/_jsx(\"option\", {\n              value: \"option\",\n              children: \"Option\"\n            }), /*#__PURE__*/_jsx(\"option\", {\n              value: \"checkbox\",\n              children: \"Checkbox\"\n            }), /*#__PURE__*/_jsx(\"option\", {\n              value: \"upload_file\",\n              children: \"Upload file\"\n            })]\n          })]\n        }), /*#__PURE__*/_jsx(\"div\", {\n          onClick: createCreatePoinItem,\n          className: \"py-2 px-4 text-center mt-4 bg-blue-400 text-white rounded-lg text-sm cursor-pointer\",\n          children: \"Tambah Poin Item Baru\"\n        })]\n      })\n    })]\n  });\n};","map":null,"metadata":{},"sourceType":"module"}